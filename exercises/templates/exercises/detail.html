{% extends 'main/base.html' %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h2 class="mb-0">{{ exercise.title }}</h2>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <span class="badge bg-info">{{ exercise.get_difficulty_display }}</span>
                        <span class="badge bg-secondary">{{ exercise.estimated_time }} –º–∏–Ω—É—Ç</span>
                        <span class="badge bg-success">{{ exercise.category.name }}</span>
                    </div>
                    
                    <h4>–û–ø–∏—Å–∞–Ω–∏–µ</h4>
                    <p class="lead">{{ exercise.description }}</p>
                    
                    <h4 class="mt-4">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h4>
                    <div class="instruction-box p-3 bg-light rounded">
                        {{ exercise.instruction|linebreaks }}
                    </div>
                    
                    {% if exercise.text_content %}
                    <h4 class="mt-4">–¢–µ–∫—Å—Ç –¥–ª—è –æ–∑–≤—É—á–∫–∏</h4>
                    <div class="text-content p-3 bg-light rounded">
                        {{ exercise.text_content|linebreaks }}
                    </div>
                    {% endif %}
                    
                    {% if exercise.audio_example %}
                    <h4 class="mt-4">–ü—Ä–∏–º–µ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h4>
                    <audio controls class="w-100">
                        <source src="{{ exercise.audio_example.url }}" type="audio/mpeg">
                        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã.
                    </audio>
                    {% endif %}
                </div>
                <div class="card-footer">
                    <div class="d-grid gap-2">
                        <a href="{% url 'exercises:record' exercise.id %}" 
                           class="btn btn-success btn-lg">
                            üé§ –ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å
                        </a>
                        <a href="{% url 'exercises:list' %}" class="btn btn-secondary">
                            ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card shadow">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h5>
                </div>
                <div class="card-body">
                    <p><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å:</strong> {{ exercise.get_difficulty_display }}</p>
                    <p><strong>–í—Ä–µ–º—è:</strong> {{ exercise.estimated_time }} –º–∏–Ω—É—Ç</p>
                    <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{ exercise.category.name }}</p>
                    <p><strong>–î–æ–±–∞–≤–ª–µ–Ω–æ:</strong> {{ exercise.created_at|date:"d.m.Y" }}</p>
                    
                    {% if user.is_authenticated %}
                    <hr>
                    <h6>–í–∞—à–∏ –ø–æ–ø—ã—Ç–∫–∏:</h6>
                    <p class="text-muted">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è —ç—Ç–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è.</p>
                    <a href="{% url 'exercises:record' exercise.id %}" class="btn btn-outline-primary btn-sm">
                        –°–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—É—é –ø–æ–ø—ã—Ç–∫—É
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .instruction-box, .text-content {
        white-space: pre-line;
    }
    
    audio {
        border-radius: 5px;
        background: #f8f9fa;
    }
</style>
{% endblock %}